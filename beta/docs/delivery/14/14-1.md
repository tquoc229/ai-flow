# 14-1 Cấu hình và Khởi tạo Cơ bản

@Back to task list

## Description

Là một nhà phát triển, tôi muốn cấu hình và khởi tạo thư viện Trình chỉnh sửa Trực quan để nó có thể giao tiếp với Directus và có thể được bật/tắt một cách linh hoạt.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
| --------- | ---------- | ----------- | --------- | ------- | ---- |
|           |            |             |           |         |      |

## Requirements

1. Tạo các biến môi trường cần thiết (`DIRECTUS_URL`, `VISUAL_EDITOR_ENABLED`).
2. Viết một module khởi tạo trình chỉnh sửa, đọc các biến môi trường và thiết lập kết nối với Directus.
3. Tạo một hook hoặc utility function (`useVisualEditor`) để kiểm tra xem tính năng có được bật hay không và người dùng có được xác thực hay không.
4. Đảm bảo rằng nếu `VISUAL_EDITOR_ENABLED` là `false`, không có script nào của trình chỉnh sửa được tải.

## Implementation Plan

- **File:** `.env.local`
  - Thêm `DIRECTUS_URL=https://your-directus-instance.com/`
  - Thêm `NEXT_PUBLIC_VISUAL_EDITOR_ENABLED=true`
- **File:** `lib/directus/visual-editor.ts` (or similar)
  - Tạo hàm `initVisualEditor()` để khởi tạo client của Directus Visual Editor.
  - Hàm này sẽ đọc các biến môi trường.
- **File:** `hooks/useVisualEditor.ts`
  - Tạo custom hook `useVisualEditor`.
  - Hook này sẽ trả về một boolean cho biết trình chỉnh sửa có nên được hiển thị hay không, dựa trên `NEXT_PUBLIC_VISUAL_EDITOR_ENABLED` và trạng thái xác thực của người dùng (cần tích hợp logic kiểm tra token/cookie của Directus).
- **File:** `components/layout.tsx` (or a root component)
  - Gọi `initVisualEditor()` một cách có điều kiện dựa trên `useVisualEditor`.

## Verification

- Kiểm tra xem các biến môi trường có được đọc chính xác hay không.
- Xác minh rằng script của Visual Editor chỉ được tải khi `NEXT_PUBLIC_VISUAL_EDITOR_ENABLED` là `true` và người dùng đã xác thực.
- Khi `NEXT_PUBLIC_VISUAL_EDITOR_ENABLED` là `false`, không có yêu cầu mạng nào liên quan đến Visual Editor được thực hiện.

## Files Modified

- `.env.local`
- `lib/directus/visual-editor.ts`
- `hooks/useVisualEditor.ts`
- `components/layout.tsx`
